<div class="focus-group-form">
  <!-- HEADER -->
  <div class="form-header">
    <h1>{{ editando ? '‚úèÔ∏è Editar Focus Group' : '‚ûï Crear Focus Group' }}</h1>
    <button class="btn btn-text" (click)="volver()">‚Üê Volver</button>
  </div>

  <!-- LOADING -->
  <div class="loading" *ngIf="cargando">
    <div class="spinner"></div>
    <p>Cargando datos...</p>
  </div>

  <!-- FORMULARIO -->
  <div *ngIf="!cargando" class="form-wrapper">
    <!-- INFORMACI√ìN GENERAL -->
    <form [formGroup]="formFocusGroup" class="form-section">
      <h2>üìã Informaci√≥n General</h2>
      
      <div class="form-group">
        <label>Nombre del Taller *</label>
        <input 
          type="text" 
          formControlName="nombre_taller"
          class="form-control"
          placeholder="Ej: Taller de Procesos Administrativos">
        <small *ngIf="formFocusGroup.get('nombre_taller')?.invalid && formFocusGroup.get('nombre_taller')?.touched" 
          class="error-text">
          M√≠nimo 3 caracteres requeridos
        </small>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Fecha *</label>
          <input 
            type="date" 
            formControlName="fecha"
            class="form-control">
        </div>
        <div class="form-group">
          <label>Duraci√≥n (minutos) *</label>
          <input 
            type="number" 
            formControlName="duracion"
            class="form-control"
            min="5">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Moderador *</label>
          <input 
            type="text" 
            formControlName="moderador"
            class="form-control"
            placeholder="Nombre del moderador">
        </div>
        <div class="form-group">
          <label>Ubicaci√≥n/Sala *</label>
          <input 
            type="text" 
            formControlName="ubicacion"
            class="form-control"
            placeholder="Ej: Sala de Conferencias A">
        </div>
      </div>
    </form>

    <!-- PARTICIPANTES -->
    <div class="form-section">
      <h2>üë• Participantes ({{ participantes_temp.length }})</h2>
      
      <form [formGroup]="formParticipante" class="form-subsection">
        <div class="form-row">
          <div class="form-group">
            <label>Nombre *</label>
            <input 
              type="text" 
              formControlName="nombre"
              class="form-control"
              placeholder="Nombre del participante">
          </div>
          <div class="form-group">
            <label>Rol *</label>
            <select formControlName="rol" class="form-control">
              <option value="stakeholder">Stakeholder</option>
              <option value="usuario_final">Usuario Final</option>
              <option value="tecnico">T√©cnico</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>√Årea *</label>
            <input 
              type="text" 
              formControlName="area"
              class="form-control"
              placeholder="Ej: Finanzas">
          </div>
          <div class="form-group">
            <label>Email *</label>
            <input 
              type="email" 
              formControlName="email"
              class="form-control"
              placeholder="email@ejemplo.com">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Nivel de Influencia</label>
            <select formControlName="nivel_influencia" class="form-control">
              <option value="bajo">Bajo</option>
              <option value="medio">Medio</option>
              <option value="alto">Alto</option>
            </select>
          </div>
          <div class="form-group">
            <button 
              type="button" 
              class="btn btn-secondary"
              (click)="agregarParticipante()">
              ‚ûï Agregar
            </button>
          </div>
        </div>
      </form>

      <div class="items-list" *ngIf="participantes_temp.length > 0">
        <div class="item" *ngFor="let p of participantes_temp">
          <div class="item-info">
            <strong>{{ p.nombre }}</strong>
            <span class="badge-small">{{ p.rol }}</span>
            <span class="badge-small">{{ p.area }}</span>
          </div>
          <button 
            type="button" 
            class="btn-delete"
            (click)="eliminarParticipante(p.id)">
            ‚ùå
          </button>
        </div>
      </div>
    </div>

    <!-- OBJETIVOS -->
    <div class="form-section">
      <h2>üéØ Objetivos ({{ objetivos_temp.length }})</h2>
      
      <form [formGroup]="formObjetivo" class="form-subsection">
        <div class="form-group">
          <label>Objetivo Principal *</label>
          <textarea 
            formControlName="descripcion"
            class="form-control"
            placeholder="Describe el objetivo principal del focus group"
            rows="3"></textarea>
        </div>
        <button 
          type="button" 
          class="btn btn-secondary"
          (click)="agregarObjetivo()">
          ‚ûï Agregar Objetivo
        </button>
      </form>

      <div class="items-list" *ngIf="objetivos_temp.length > 0">
        <div class="item" *ngFor="let o of objetivos_temp">
          <div class="item-info">
            <p>{{ o.descripcion }}</p>
          </div>
          <button 
            type="button" 
            class="btn-delete"
            (click)="eliminarObjetivo(o.id)">
            ‚ùå
          </button>
        </div>
      </div>
    </div>

    <!-- REQUERIMIENTOS -->
    <div class="form-section">
      <h2>üìù Requerimientos Identificados ({{ requerimientos_temp.length }})</h2>
      
      <form [formGroup]="formRequerimiento" class="form-subsection">
        <div class="form-row">
          <div class="form-group">
            <label>C√≥digo *</label>
            <input 
              type="text" 
              formControlName="codigo"
              class="form-control"
              placeholder="REQ-001">
          </div>
          <div class="form-group">
            <label>Prioridad</label>
            <select formControlName="prioridad" class="form-control">
              <option value="bajo">Bajo</option>
              <option value="medio">Medio</option>
              <option value="alto">Alto</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Descripci√≥n *</label>
            <textarea 
              formControlName="descripcion"
              class="form-control"
              placeholder="Descripci√≥n del requerimiento"
              rows="2"></textarea>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Categor√≠a</label>
            <select formControlName="categoria" class="form-control">
              <option value="funcional">Funcional</option>
              <option value="no_funcional">No Funcional</option>
              <option value="tecnico">T√©cnico</option>
            </select>
          </div>
          <div class="form-group">
            <button 
              type="button" 
              class="btn btn-secondary"
              (click)="agregarRequerimiento()">
              ‚ûï Agregar
            </button>
          </div>
        </div>
      </form>

      <div class="items-list" *ngIf="requerimientos_temp.length > 0">
        <div class="item" *ngFor="let r of requerimientos_temp">
          <div class="item-info">
            <strong>{{ r.codigo }}</strong>
            <span [class]="'badge-small priority-' + r.prioridad">{{ r.prioridad }}</span>
            <p>{{ r.descripcion }}</p>
          </div>
          <button 
            type="button" 
            class="btn-delete"
            (click)="eliminarRequerimiento(r.id)">
            ‚ùå
          </button>
        </div>
      </div>
    </div>

    <!-- ACCIONES -->
    <div class="form-actions">
      <button class="btn btn-secondary" (click)="volver()" [disabled]="guardando">
        Cancelar
      </button>
      <button 
        class="btn btn-primary" 
        (click)="guardar()"
        [disabled]="guardando || formFocusGroup.invalid">
        {{ guardando ? '‚è≥ Guardando...' : (editando ? 'üíæ Guardar Cambios' : 'üíæ Crear Focus Group') }}
      </button>
    </div>
  </div>
</div>